# 機械学習の世界へようこそ！

このページは、東京工業大学デジタル創作同好会traP Kaggle班 (https://trap.jp/kaggle/) の主催する、
「機械学習講習会」 の資料です。　

機械学習講習会は、以下のようなことを目標にしています。

- はじめて見た問題に対して、機械学習を使ってアプローチできるようになること
- 今後、機械学習のさまざまな手法を学ぶときに基礎になる力をつけること

逆に、次のようなことは目標にしていません。

- 機械学習のさまざまな手法を網羅的に学ぶこと
- 性能向上のための繊細なテクニックや実装技法を身につけること 


機械学習は非常に多くの手法、側面を持つ分野なので、全七回の講習会で全てを網羅することはできません。

そのため、この講習会では広い機械学習の分野のうち、とくに **「ディープラーニング」** という手法を取り上げます。
機械学習に触れたことがない人でもディープラーニングという言葉は聞いたことがあるかもしれません。

ディープラーニングはとくに現在(2024年)、インパクトのある成果を次々生み出している、
機械学習の中でも特に注目されている手法です。　おそらく講習会に参加する人も興味がある人が多いと思います。

やはり興味があるものを学ぶのが一番楽しいと思うので、この講習会ではディープラーニングをとくに取り上げて、それを通じて機械学習の基本的なアイデアを学ぼうと思います。

また、「理論だけで実際に問題解決の手段としては使えない」、あるいは「ライブラリの使い方をなぞるだけで背景は何も理解していない」とならないよう、
どちらもバランスよく取り上げていくつもりです。


さて、機械学習は、数学とコンピュータサイエンスの力を使って鮮やかに問題を解決することができる、とても面白い分野です。

この講習会を通じて、機械学習の世界を少しでも楽しんでいただければ幸いです。

## 具体的な内容について

この講習会は、全七回 (+ この前書き) の構成です。


|      | 内容                          | 
|---------|-----------------------------|
| 学習            |  「学習」について説明できるようになる
| 勾配降下法      |  基本的な連続最適化について理解して、アルゴリズムを実装できるようになる     |
| 自動微分とPyTorch | PyTorch を使ってプログラムに勾配を求めさせられるようになる. 自動微分のアルゴリズムについても扱う |
| ニューラルネットワークの構造 |   ニューラルネットワークの基本的なアイデアを理解し、実装できるようになる |
| ニューラルネットワークの学習と評価 |  ニューラルネットワークの学習技法について学び、またバリデーションについても学ぶ |
| ニューラルネットワークの実装 | PyTorch を使ってニューラルネットワークを実装できるようになる |
| 機械学習の応用とデータ分析コンペ　|　 この講習会で扱わなかった手法や応用例について学び、またデータ分析コンペなどの競技などを取り上げる |


全体の流れとしては、まずは機械学習の枠組みを理解し、それに必要なアルゴリズムを学んだのち、
ニューラルネットワークについて詳しく扱って実装できるようになることを目指します。

### 演習問題とコンペ

#### オンラインジャッジシステムについて

最初に書いたように、機械学習アルゴリズムを実際に使うには実装に習熟する必要があります。

そこでこの講習会ではオンラインジャッジシステムを用意しています。

この講習会で扱ったアルゴリズムに関連する問題を用意しているので、実践の場として活用してください。

(更新予定: 講習会が終了次第、開発したオンラインジャッジシステムはOSSとして公開する予定です)

#### コンペについて

機械学習講習会で学んだ内容の実践の場として、最終課題としてデータ分析コンペを開催します。

(更新予定: 講習会が終了次第、開発したコンペプラットフォームはOSSとして公開する予定です)


## 環境構築について

このコンペでは、基本的に Python を使うことを想定しています。

また多くの場合、対話的な Python の実行環境である Jupyter Notebook を使うと便利な場面が多いです。

ここでは、環境構築にあまり慣れていない人むけに Google Colaboratory というサービスを使ってこれらを利用する方法を紹介します。

環境構築を自前で行える人は次の節まで読み飛ばしてください。

### Google Colaboratory の使い方

まずは、 [https://colab.research.google.com/?hl=ja](https://colab.research.google.com/?hl=ja) にアクセスしてみてください。

![](img/colab.png)


このような画面が出てきたかと思います。
まずは、右上の青い「ログイン」を押してください。


![](img/notebookcreate.png)

するとこのような画面になると思うので、
次に真ん中のポップアップの下にある青い文字の「ノートブックを新規作成」をクリックしてください。


![](img/notebook.png)

このような画面になっていれば成功です！

それでは次にこの画面の意味や JupyterNotebook そのものについて見ていきます。
この画面は開いたままにして、次へ進んでください！

### Jupyter Notebook とは

いきなり馴染みのない画面に飛ばされて困惑している人もいるかもしれないですが、ひとまずこれが何者なのか確かめようと思います。

まず、先ほどの画面の「1」と書いてあるところの右をクリックしてみてください。
入力可能になっているかと思います。

![alt text](img/input.png)


そこに　`print('Hello Jupyter!')` と書き、左の再生ボタンをクリックしてみましょう。
(初めてこれをクリックした場合は、接続が入って少し待たされますが正常なのでじっと待ってください)


![alt text](img/image-1.png)



`Hello Jupyter` と表示されました！
いうまでもなく、これは Python のコードを実行した結果です。

このように、 JupyterNotebook では、
この入力可能な欄に Python のプログラムの書き込み、実行ができます。

もう少し進めてみましょう。
まずは、次の入力欄に次のようなコードを書きます。

`weather = '晴れ'`

これを実行して、そのまた次の入力欄に

`print('今日の天気は' + weather)` と書き、実行してみます。

![alt text](image/image-2.png)

すると、`今日の天気は晴れ` と表示されました。

このように、 Jupyter Notebook の各欄では変数などが共有されていて、全体として一つのプログラムのように振舞います。

それぞれの入力欄のことを「セル」と呼びます。つまり、今回は三つのセルに分けてコードを書いたわけです。

今後 JupyterNotebook を使い倒すことになると思うので、
色々なプログラムの実装を試してみて慣れておくとスムーズにいきそうです。


### なぜ Jupyter Notebook を使うのか？

他の言語の実行方法や、競技プログラミングに取り組んでいる人などからすると、"通常の" 実行方式、つまり
「ファイル作成 -> `python {ファイル名}.py` 」 という方法を使えばいいじゃないか、と思うかもしれません。

しかし、 Jupyter Notebook はデータ分析・機械学習をに関わる多くのエンジニア・研究者にとって**必須**のツールになっています。

利点はさまざまありますが、簡単には次のようなものがあげられると思います。

#### 1. 処理を簡単に切り分けられる

データ分析、機械学習は試行錯誤が多い作業です。

Jupyter Notebook を使うと、セルごとに処理を切り分けることで極めて簡単に試行錯誤をする
部分を小さくしていくことができます。

#### 2. データの可視化が簡単

これはその目で確かめるのがいいと思います。

次のコードを貼り付けて実行してみてください。

```python
import seaborn as sns
import matplotlib.pyplot as plt

sns.set(style="whitegrid", context="talk", palette="viridis")
titanic = sns.load_dataset('titanic')
plt.figure(figsize=(14, 8))

histplot = sns.histplot(data=titanic, x='age', hue='survived', multiple='stack', palette='viridis', kde=True)

plt.title('Age Distribution of Titanic Passengers', fontsize=20, fontweight='bold')
plt.xlabel('Age', fontsize=16)
plt.ylabel('Count', fontsize=16)
plt.legend(title='Survived', labels=['Not Survived', 'Survived'], fontsize=14, title_fontsize=16)
plt.grid(True, linestyle='--', linewidth=0.7, alpha=0.7)
plt.gca().set_facecolor('#f0f0f0')

plt.show()
```

真下に、なかなか綺麗なグラフが表示されると思います。

Jupyter Notebook は各セルの出力としてテキストだけでなく画像なども表示でき、対話的にデータを確認するのに非常に便利です。
(ちなみに、このグラフは有名なタイタニック号沈没事故の乗客の年齢分布を生存者と非生存者で比較したものです)
